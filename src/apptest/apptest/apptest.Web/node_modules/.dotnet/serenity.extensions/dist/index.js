var kt=Object.create;var ce=Object.defineProperty,Ft=Object.defineProperties,qt=Object.getOwnPropertyDescriptor,Nt=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var Ke=Object.prototype.hasOwnProperty,Ge=Object.prototype.propertyIsEnumerable;var Ue=(r,e)=>(e=Symbol[r])?e:Symbol.for("Symbol."+r),Q=r=>{throw TypeError(r)};var pe=(r,e,t)=>e in r?ce(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Y=(r,e)=>{for(var t in e||(e={}))Ke.call(e,t)&&pe(r,t,e[t]);if(_)for(var t of _(e))Ge.call(e,t)&&pe(r,t,e[t]);return r},de=(r,e)=>Ft(r,Nt(e)),i=(r,e)=>ce(r,"name",{value:e,configurable:!0});var We=(r,e)=>{var t={};for(var o in r)Ke.call(r,o)&&e.indexOf(o)<0&&(t[o]=r[o]);if(r!=null&&_)for(var o of _(r))e.indexOf(o)<0&&Ge.call(r,o)&&(t[o]=r[o]);return t};var f=r=>{var e;return[,,,kt((e=r==null?void 0:r[Ue("metadata")])!=null?e:null)]},ze=["class","method","getter","setter","accessor","field","value","get","set"],J=r=>r!==void 0&&typeof r!="function"?Q("Function expected"):r,Bt=(r,e,t,o,s)=>({kind:ze[r],name:e,metadata:o,addInitializer:l=>t._?Q("Already initialized"):s.push(J(l||null))}),Ht=(r,e)=>pe(e,Ue("metadata"),r[3]),g=(r,e,t,o)=>{for(var s=0,l=r[e>>1],u=l&&l.length;s<u;s++)e&1?l[s].call(t):o=l[s].call(t,o);return o},h=(r,e,t,o,s,l)=>{var u,a,n,c,m,p=e&7,P=!!(e&8),x=!!(e&16),d=p>3?r.length+1:p?P?1:2:0,E=ze[p+5],w=p>3&&(r[d-1]=[]),D=r[d]||(r[d]=[]),b=p&&(!x&&!P&&(s=s.prototype),p<5&&(p>3||!x)&&qt(p<4?s:{get[t](){return Me(this,l)},set[t](y){return Ve(this,l,y)}},t));p?x&&p<4&&i(l,(p>2?"set ":p>1?"get ":"")+t):i(s,t);for(var R=o.length-1;R>=0;R--)c=Bt(p,t,n={},r[3],D),p&&(c.static=P,c.private=x,m=c.access={has:x?y=>jt(s,y):y=>t in y},p^3&&(m.get=x?y=>(p^1?Me:Mt)(y,s,p^4?l:b.get):y=>y[t]),p>2&&(m.set=x?(y,S)=>Ve(y,s,S,p^4?l:b.set):(y,S)=>y[t]=S)),a=(0,o[R])(p?p<4?x?l:b[E]:p>4?void 0:{get:b.get,set:b.set}:s,c),n._=1,p^4||a===void 0?J(a)&&(p>4?w.unshift(a):p?x?l=a:b[E]=a:s=a):typeof a!="object"||a===null?Q("Object expected"):(J(u=a.get)&&(b.get=u),J(u=a.set)&&(b.set=u),J(u=a.init)&&w.unshift(u));return p||Ht(r,s),b&&ce(s,t,b),x?p^4?l:b:s};var me=(r,e,t)=>e.has(r)||Q("Cannot "+t),jt=(r,e)=>Object(e)!==e?Q('Cannot use the "in" operator on this value'):r.has(e),Me=(r,e,t)=>(me(r,e,"read from private field"),t?t.call(r):e.get(r));var Ve=(r,e,t,o)=>(me(r,e,"write to private field"),o?o.call(r,t):e.set(r,t),t),Mt=(r,e,t)=>(me(r,e,"access private method"),t);import{PasswordEditor as Vt,PrefixedContext as Kt,initFormType as Gt}from"@serenity-is/corelib";var A=class A extends Kt{constructor(e){if(super(e),!A.init){A.init=!0;var t=Vt;Gt(A,["OldPassword",t,"NewPassword",t,"ConfirmPassword",t])}}};i(A,"ChangePasswordForm"),A.formKey="Serenity.Extensions.ChangePasswordRequest";var Je=A;import{EmailAddressEditor as Ut,PrefixedContext as Wt,initFormType as zt}from"@serenity-is/corelib";var L=class L extends Wt{constructor(e){if(super(e),!L.init){L.init=!0;var t=Ut;zt(L,["Email",t])}}};i(L,"ForgotPasswordForm"),L.formKey="Serenity.Extensions.ForgotPasswordRequest";var Qe=L;import{PasswordEditor as Jt,PrefixedContext as Qt,initFormType as Yt}from"@serenity-is/corelib";var k=class k extends Qt{constructor(e){if(super(e),!k.init){k.init=!0;var t=Jt;Yt(k,["NewPassword",t,"ConfirmPassword",t])}}};i(k,"ResetPasswordForm"),k.formKey="Serenity.Extensions.ResetPasswordRequest";var Ye=k;import{fieldsProxy as Xt}from"@serenity-is/corelib";var T=class T{};i(T,"UserPreferenceRow"),T.idProperty="UserPreferenceId",T.nameProperty="Name",T.localTextPrefix="Common.UserPreference",T.deletePermission="",T.insertPermission="",T.readPermission="",T.updatePermission="",T.Fields=Xt();var Xe=T;import{serviceRequest as Zt}from"@serenity-is/corelib";var X;(t=>(t.baseUrl="Extensions/UserPreference",t.Methods={Update:"Extensions/UserPreference/Update",Retrieve:"Extensions/UserPreference/Retrieve"},["Update","Retrieve"].forEach(o=>{t[o]=function(s,l,u){return Zt(t.baseUrl+"/"+o,s,l,u)}})))(X||(X={}));import{Decorators as pr,DialogTexts as cr,BaseDialog as dr,localText as et}from"@serenity-is/corelib";var xe=Object.keys;function $t(r){return typeof r=="boolean"}i($t,"isBoolean");function _t(r){return r&&typeof r.nodeType=="number"}i(_t,"isElement");function be(r){return typeof r=="string"}i(be,"isString");function er(r){return typeof r=="number"}i(er,"isNumber");function F(r){return typeof r=="object"?r!==null:Z(r)}i(F,"isObject");function Z(r){return typeof r=="function"}i(Z,"isFunction");function tr(r){let{prototype:e}=r;return!!(e&&e.isReactComponent)}i(tr,"isComponentClass");function rr(r){return F(r)&&typeof r.length=="number"&&typeof r.nodeType!="number"}i(rr,"isArrayLike");function ge(r,e){if(r)for(let t of xe(r))e(r[t],t)}i(ge,"forEach");function or(r){return F(r)&&"current"in r}i(or,"isRef");var sr=Symbol.for("jsx-dom:type"),Ze=function(r){return r.ShadowRoot="ShadowRoot",r}(Ze||{});function ir(r){return r!=null&&r[sr]===Ze.ShadowRoot}i(ir,"isShadowRoot");function $e(r){return!$t(r)&&r!=null}i($e,"isVisibleChild");function he(r){return Array.isArray(r)?r.map(he).filter(Boolean).join(" "):F(r)?Symbol.iterator in r?he(Array.from(r)):xe(r).filter(e=>r[e]).join(" "):$e(r)?""+r:""}i(he,"className");var Ce=class Ce{constructor(e){this.props=e}render(){return null}};i(Ce,"Component");var ye=Ce;ye.prototype;function nr(r,e,t){e=de(Y({},e),{children:t});let o=new r(e),s=o.render();return"ref"in e&&ve(e.ref,o),s}i(nr,"initComponentClass");function v(r,e){let l=e,{children:t}=l,o=We(l,["children"]),s;if(be(r)){if(s=o.namespaceURI?document.createElementNS(o.namespaceURI,r):document.createElement(r),ur(o,s),Pe(t,s),s instanceof window.HTMLSelectElement&&o.value!=null)if(o.multiple===!0&&Array.isArray(o.value)){let u=o.value.map(a=>String(a));s.querySelectorAll("option").forEach(a=>a.selected=u.includes(a.value))}else s.value=o.value;ve(o.ref,s)}else if(Z(r))F(r.defaultProps)&&(o=Y(Y({},r.defaultProps),o)),s=tr(r)?nr(r,o,t):r(de(Y({},o),{children:t}));else throw new TypeError(`Invalid JSX element type: ${r}`);return s}i(v,"jsx");function ve(r,e){or(r)?r.current=e:Z(r)&&r(e)}i(ve,"attachRef");function Pe(r,e){if(rr(r))ar(r,e);else if(be(r)||er(r))fe(document.createTextNode(r),e);else if(r===null)fe(document.createComment(""),e);else if(_t(r))fe(r,e);else if(ir(r)){let t=e.attachShadow(r.attr);Pe(r.children,t),ve(r.ref,t)}}i(Pe,"appendChild");function ar(r,e){for(let t of[...r])Pe(t,e);return e}i(ar,"appendChildren");function fe(r,e){e instanceof window.HTMLTemplateElement?e.content.appendChild(r):e.appendChild(r)}i(fe,"appendChildToNode");function _e(r,e){e==null||e===!1||(Array.isArray(e)?e.forEach(t=>_e(r,t)):be(e)?r.setAttribute("style",e):F(e)&&ge(e,(t,o)=>{o.indexOf("-")===0?r.style.setProperty(o,t):r.style[o]=t}))}i(_e,"style");function lr(r,e,t){switch(r){case"htmlFor":ee(t,"for",e);return;case"dataset":ge(e,(o,s)=>{o!=null&&(t.dataset[s]=o)});return;case"innerHTML":case"innerText":case"textContent":$e(e)&&(t[r]=e);return;case"dangerouslySetInnerHTML":F(e)&&(t.innerHTML=e.__html);return;case"value":if(e==null||t instanceof window.HTMLSelectElement)return;if(t instanceof window.HTMLTextAreaElement){t.value=e;return}break;case"spellCheck":t.spellcheck=e;return;case"class":case"className":Z(e)?e(t):ee(t,"class",he(e));return;case"ref":case"namespaceURI":return;case"style":_e(t,e);return;case"on":case"onCapture":ge(e,(o,s)=>{t.addEventListener(s,o,r==="onCapture")});return}if(Z(e)){if(r[0]==="o"&&r[1]==="n"){let o=r.toLowerCase(),s=o.endsWith("capture");if(o==="ondoubleclick"?o="ondblclick":s&&o==="ondoubleclickcapture"&&(o="ondblclickcapture"),!s&&t[o]===null)t[o]=e;else if(s)t.addEventListener(o.substring(2,o.length-7),e,!0);else{let l;o in window?l=o.substring(2):l=o[2]+r.slice(3),t.addEventListener(l,e)}}}else F(e)?t[r]=e:e===!0?ee(t,r,""):e!==!1&&e!=null&&ee(t,r,e)}i(lr,"attribute");function ee(r,e,t){r.setAttribute(e,t)}i(ee,"attr");function ur(r,e){for(let t of xe(r))lr(t,r[t],e);return e}i(ur,"attributes");var tt,Te,mr;tt=[pr.registerClass("Serenity.Extensions.BasicProgressDialog")];var H=class H extends(mr=dr){constructor(e){super(e),this.dialogTitle=et("Site.BasicProgressDialog.PleaseWait")}get max(){return parseInt(this.byId("ProgressBar").attr("aria-valuemax"),10)}set max(e){this.byId("ProgressBar").attr("aria-valuemax",(e||100).toString())}get value(){return parseInt(this.byId("ProgressBar").attr("aria-valuenow"),10)}set value(e){this.byId("ProgressBar").attr("aria-valuenow",(e||0).toString()).text(e+" / "+this.max).getNode().style.width=(e||0)/(this.max||100)*100+"%"}get title(){return this.dialogTitle}set title(e){this.dialogTitle=e}getDialogButtons(){return[{text:cr.CancelButton,class:"btn btn-danger",click:i(()=>{var e,t;this.cancelled=!0,(e=this.domNode.closest(".ui-dialog").querySelectorAll(".ui-dialog-buttonpane .ui-button"))==null||e.forEach(o=>{o.setAttribute("disabled","disabled"),o.style.opacity="0.5"}),this.dialogTitle=((t=this.cancelTitle)==null?void 0:t.trim())||et("Site.BasicProgressDialog.CancelTitle")},"click")}]}getDialogOptions(){var e=super.getDialogOptions();return e.width=600,e}initDialog(){var t;super.initDialog();var e=(t=this.domNode.closest(".ui-dialog"))==null?void 0:t.querySelector(".ui-dialog-titlebar-close");e&&(e.style.display="none")}renderContents(){let e=this.useIdPrefix();return v("div",{class:"s-DialogContent s-BasicProgressDialogContent",children:[v("div",{id:e.StatusText,class:"status-text"}),v("div",{id:e.Progress,class:"progress",style:"height: 1.5rem",children:v("div",{id:e.ProgressBar,class:"progress-bar","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100})})]})}};Te=f(mr),H=h(Te,0,"BasicProgressDialog",tt,H),i(H,"BasicProgressDialog"),g(Te,1,H);var te=H;import{confirmDialog as fr,localText as I,notifyError as rt,notifySuccess as gr,notifyWarning as hr,stringFormat as j}from"@serenity-is/corelib";var Se=class Se{createProgressDialog(){this.progressDialog=new te({}),this.progressDialog.dialogOpen(),this.progressDialog.max=this.keys.length,this.progressDialog.value=0}getConfirmationFormat(){return I("Site.BulkServiceAction.ConfirmationFormat")}getConfirmationMessage(e){return j(this.getConfirmationFormat(),e)}confirm(e,t){fr(this.getConfirmationMessage(e),t)}getNothingToProcessMessage(){return I("Site.BulkServiceAction.NothingToProcess")}nothingToProcess(){rt(this.getNothingToProcessMessage())}getParallelRequests(){return 1}getBatchSize(){return 1}startParallelExecution(){this.createProgressDialog(),this.successCount=0,this.errorCount=0,this.pendingRequests=0,this.completedRequests=0,this.errorCount=0,this.errorByKey={},this.queue=this.keys.slice(),this.queueIndex=0;for(var e=this.getParallelRequests();e-- >0;)this.executeNextBatch()}serviceCallCleanup(){this.pendingRequests--,this.completedRequests++;var e=I(this.progressDialog.cancelled?"Site.BasicProgressDialog.CancelTitle":"Site.BasicProgressDialog.PleaseWait");e+=" (",this.successCount>0&&(e+=j(I("Site.BulkServiceAction.SuccessCount"),this.successCount)),this.errorCount>0&&(this.successCount>0&&(e+=", "),e+=j(I("Site.BulkServiceAction.ErrorCount"),this.errorCount)),this.progressDialog.title=e+")",this.progressDialog.value=this.successCount+this.errorCount,!this.progressDialog.cancelled&&this.progressDialog.value<this.keys.length?this.executeNextBatch():this.pendingRequests===0&&(this.progressDialog.dialogClose("done"),this.showResults(),this.done&&(this.done(),this.done=null))}executeForBatch(e){}executeNextBatch(){for(var e=this.getBatchSize(),t=[];!(t.length>=e||this.queueIndex>=this.queue.length);)t.push(this.queue[this.queueIndex++]);t.length>0&&(this.pendingRequests++,this.executeForBatch(t))}getAllHadErrorsFormat(){return I("Site.BulkServiceAction.AllHadErrorsFormat")}showAllHadErrors(){rt(j(this.getAllHadErrorsFormat(),this.errorCount))}getSomeHadErrorsFormat(){return I("Site.BulkServiceAction.SomeHadErrorsFormat")}showSomeHadErrors(){hr(j(this.getSomeHadErrorsFormat(),this.successCount,this.errorCount))}getAllSuccessFormat(){return I("Site.BulkServiceAction.AllSuccessFormat")}showAllSuccess(){gr(j(this.getAllSuccessFormat(),this.successCount))}showResults(){if(this.errorCount===0&&this.successCount===0){this.nothingToProcess();return}if(this.errorCount>0&&this.successCount===0){this.showAllHadErrors();return}if(this.errorCount>0){this.showSomeHadErrors();return}this.showAllSuccess()}execute(e){if(this.keys=e,this.keys.length===0){this.nothingToProcess();return}this.confirm(this.keys.length,()=>this.startParallelExecution())}get_successCount(){return this.successCount}set_successCount(e){this.successCount=e}get_errorCount(){return this.errorCount}set_errorCount(e){this.errorCount=e}};i(Se,"BulkServiceAction");var ot=Se;import{deepClone as yr,faIcon as xr,postToService as br}from"@serenity-is/corelib";var st;(e=>{function r(t){var o,s;return{hint:(o=t.hint)!=null?o:"Excel",title:(s=t.title)!=null?s:"",cssClass:"export-xlsx-button",icon:xr("file-excel"),onClick:i(function(){if(!t.onViewSubmit())return;let l=t.grid;var u=yr(l.getView().params);u.Take=0,u.Skip=0;var a=l.getView().sortBy;a&&(u.Sort=a),u.ExportColumns=[];let n=l.getGrid().getColumns();for(let c of n)u.ExportColumns.push(c.id||c.field);t.editRequest&&(u=t.editRequest(u)),br({service:t.service,request:u,target:"_blank"})},"onClick"),separator:t.separator}}e.createToolButton=r,i(r,"createToolButton")})(st||(st={}));import{Fluent as it,deepClone as vr,formatDate as nt,resolveUrl as at,serviceCall as Pr,stringFormat as Cr}from"@serenity-is/corelib";var lt;(u=>{function r(a,n,c){return a.map(m=>{let p={dataKey:m.id||m.field,title:m.name||""};c&&c[p.dataKey]!=null&&(p.title=c[p.dataKey]);let P={};return(m.cssClass||"").indexOf("align-right")>=0?P.halign="right":(m.cssClass||"").indexOf("align-center")>=0&&(P.halign="center"),n[p.dataKey]=P,p})}i(r,"toAutoTableColumns");function e(a,n,c,m){let p=document.createElement("span"),P=0;return n.map(x=>{var b,R,y;let d=[];for(let S=0;S<m.length;S++){var E=m[S],w=a.getFormatter(P,E),D=a.getFormatterContext(P,S);D.item=x,D.value=x[E.field];let C=w?w(D):"";!C||!(C instanceof Node)&&C.indexOf("<")<0&&C.indexOf("&")<0?d.push(C):(it.empty(p),C instanceof Node?p.appendChild(C):p.innerHTML=C,p.children.length==1&&((b=p.children[0])==null?void 0:b.nodeName)==="SELECT"?d.push((y=(R=p.children[0].querySelector("[selected]"))==null?void 0:R.textContent)!=null?y:""):p.children.length==1&&it.isInputLike(p.children[0])?d.push(p.children[0].value):p.children.length==1&&p.children[0].classList.contains(".check-box")?d.push(p.children[0].classList.contains("checked")?"X":""):d.push(p.textContent||""))}return P++,d})}i(e,"toAutoTableData");function t(a){var n=a.grid;if(a.onViewSubmit()){var c=vr(n.view.params);c.Take=0,c.Skip=0;var m=n.view.sortBy;m!=null&&(c.Sort=m);var p=n.slickGrid.getColumns();p=p.filter(x=>x.id!=="__select__"),c.IncludeColumns=[];for(var P of p)c.IncludeColumns.push(P.id||P.field);Pr({url:n.view.url,request:c,onSuccess:i(x=>l(()=>{let d=new jsPDF("l","pt"),E=p,w={},D=r(E,w,a.columnTitles);var b=D.map(O=>O.dataKey);let R=x.Entities||[],y=e(n.slickGrid,R,b,E);d.setFontSize(a.titleFontSize||10),d.setFont("helvetica","bold");let S=a.reportTitle||n.getTitle()||"Report";d.autoTableText(S,d.internal.pageSize.width/2,a.titleTop||25,{halign:"center"});var C="{{T}}";let je=a.pageNumbers==null||a.pageNumbers;var B=Object.assign({margin:{top:25,left:25,right:25,bottom:je?25:30},startY:60,styles:{fontSize:8,overflow:"linebreak",cellPadding:2,valign:"middle"},columnStyles:w},a.tableOptions),ie,ne;if(je&&(ie=i(function(O){var ue=O.pageCount;typeof d.putTotalPages=="function"&&(ue=ue+" / "+C),d.autoTableText(ue,d.internal.pageSize.width/2,d.internal.pageSize.height-B.margin.bottom,{halign:"center"})},"footer")),(a.printDateTimeHeader==null||a.printDateTimeHeader)&&(ne=i(function(O){d.setFont("helvetica","normal"),d.setFontSize(8),d.autoTableText(nt(new Date,"dd-MM-yyyy HH:mm"),d.internal.pageSize.width-B.margin.right,13,{halign:"right"})},"header")),B.didDrawPage=O=>{ne&&ne(O),ie&&ie(O)},B.head=[D],B.body=y,d.autoTable(B),typeof d.putTotalPages=="function"&&d.putTotalPages(C),!a.output||a.output=="file"){var ae=a.fileName||a.reportTitle||"{0}_{1}.pdf";ae=Cr(ae,n.getTitle()||"report",nt(new Date,"yyyyMMdd_HHmm")),d.save(ae);return}a.autoPrint&&d.autoPrint();var le=a.output;le=="newwindow",le="dataurlnewwindow",d.output(le)}),"onSuccess")})}}u.exportToPdf=t,i(t,"exportToPdf");function o(a){return{title:a.title||"",hint:a.hint||"PDF",cssClass:"export-pdf-button",onClick:i(()=>t(a),"onClick"),separator:a.separator}}u.createToolButton=o,i(o,"createToolButton");function s(a){if(typeof jsPDF!="undefined")return a();var n=document.getElementById("jsPDFScript");if(n)return a();n=document.createElement("script"),n.type="text/javascript",n.async=!1,n.id="jsPDFScript",n.addEventListener("load",()=>{typeof jsPDF=="undefined"&&typeof jspdf!="undefined"&&(window.jsPDF=jspdf.jsPDF),a()}),n.src=at("~/Serenity.Assets/Scripts/jspdf.min.js"),document.head.append(n)}i(s,"includeJsPDF");function l(a){s(()=>{if(typeof jsPDF=="undefined"||typeof jsPDF.API=="undefined"||typeof jsPDF.API.autoTable!="undefined")return a();var n=document.querySelector("#jsPDFAutoTableScript");if(n)return a();n=document.createElement("script"),n.async=!1,n.type="text/javascript",n.id="jsPDFAutoTableScript",n.addEventListener("load",()=>{a()}),n.src=at("~/Serenity.Assets/Scripts/jspdf.plugin.autotable.min.js"),document.head.append(n)})}i(l,"includeAutoTable")})(lt||(lt={}));import{Decorators as Tr,EnumTypeRegistry as Sr,htmlEncode as Ee,localText as Er,tryGetText as wr}from"@serenity-is/corelib";var pt,we;pt=[Tr.registerFormatter("Serenity.Extensions.EnumSelectFormatter")];var M=class M{constructor(e={}){this.props=e;var t,o,s;(t=this.props)!=null||(this.props={}),(s=(o=this.props).allowClear)!=null||(o.allowClear=!0)}format(e){var u;var t=Sr.get((u=this.props.enumKey)!=null?u:"EnumKeyOptionNotSpecified!"),o="<select>";this.props.allowClear&&(o+='<option value="">',o+=Ee(this.props.emptyItemText||Er("Controls.SelectEditor.EmptyItemText")),o+="</option>");for(var s of Object.keys(t).filter(a=>!isNaN(parseInt(a,10)))){o+='<option value="'+Ee(s)+'"',s==e.value&&(o+=" selected");var l=t[s];o+=">",o+=Ee(wr("Enums."+this.props.enumKey+"."+l)||l),o+="</option>"}return o+="</select>",o}get enumKey(){return this.props.enumKey}set enumKey(e){this.props.enumKey=e}get allowClear(){return this.props.allowClear}set allowClear(e){this.props.allowClear=e}get emptyItemText(){return this.props.emptyItemText}set emptyItemText(e){this.props.emptyItemText=e}};we=f(null),M=h(we,0,"EnumSelectFormatter",pt,M),i(M,"EnumSelectFormatter"),g(we,1,M);var ut=M;import{Decorators as Dr,htmlEncode as Rr,toSingleLine as Ir}from"@serenity-is/corelib";var dt,De;dt=[Dr.registerFormatter("Serenity.Extensions.SingleLineTextFormatter")];var q=class q{format(e){return q.formatValue(e.value)}static formatValue(e){var t=document.createElement("div");return t.innerHTML=e!=null?e:"",Rr(Ir(t.textContent))}};De=f(null),q=h(De,0,"SingleLineTextFormatter",dt,q),i(q,"SingleLineTextFormatter"),g(De,1,q);var ct=q;import{Decorators as Re,EntityGrid as Or,IGetEditValue as Ar,ISetEditValue as Lr,deepClone as re,indexOf as kr}from"@serenity-is/corelib";var ft,Ie,Fr;ft=[Re.registerClass("Serenity.Extensions.GridEditorBase",[Ar,Lr]),Re.editor(),Re.element("<div/>")];var V=class V extends(Fr=Or){constructor(t){super(t);this.nextId=1}getIdProperty(){return"__id"}id(t){return t[this.getIdProperty()]}getNextId(){return"`"+this.nextId++}setNewId(t){t[this.getIdProperty()]=this.getNextId()}save(t,o){var s=t.request,l=re(s.Entity),u=this.id(l);if(u==null&&(l[this.getIdProperty()]=this.getNextId()),!!this.validateEntity(l,u)){var a=this.view.getItems().slice();if(u==null)a.push(l);else{var n=kr(a,c=>this.id(c)===u);a[n]=re({},a[n],l)}this.setEntities(a),o({})}}deleteEntity(t){return this.view.deleteItem(t),!0}validateEntity(t,o){return!0}setEntities(t){this.view.setItems(t,!0)}getNewEntity(){return{}}getButtons(){var t=super.getButtons(),o=t.find(s=>s.action==="add");return o&&(o.onClick=()=>{this.createEntityDialog(this.getItemType(),s=>{var l=s;l.onSave=(u,a)=>this.save(u,a),this.transferDialogReadOnly(l),l.loadEntityAndOpenDialog(this.getNewEntity())})}),t.filter(s=>s.action!=="refresh")}editItem(t){var o=t,s=this.view.getItemById(o);this.createEntityDialog(this.getItemType(),l=>{var u=l;u.onDelete=(a,n)=>{this.deleteEntity(o)&&n({})},this.transferDialogReadOnly(u),u.onSave=(a,n)=>this.save(a,n),u.loadEntityAndOpenDialog(s)})}getEditValue(t,o){o[t.name]=this.value}setEditValue(t,o){this.value=t[o.name]}get value(){var t=this.getIdProperty();return this.view.getItems().map(o=>{var s=re(o),l=s[t];return l&&l.toString().charAt(0)=="`"&&delete s[t],s})}set value(t){var o=this.getIdProperty();this.view.setItems((t||[]).map(s=>{var l=re(s);return l[o]==null&&(l[o]=this.getNextId()),l}),!0)}getGridCanLoad(){return!1}usePager(){return!1}getInitialTitle(){return null}createQuickSearchInput(){}};Ie=f(Fr),V=h(Ie,0,"GridEditorBase",ft,V),i(V,"GridEditorBase"),g(Ie,1,V);var mt=V;import{Decorators as gt,EntityDialog as qr}from"@serenity-is/corelib";var yt,Oe,Nr;yt=[gt.registerClass("Serenity.Extensions.GridEditorDialog"),gt.panel(!1)];var K=class K extends(Nr=qr){getIdProperty(){return"__id"}destroy(){this.onSave=null,this.onDelete=null,super.destroy()}updateInterface(){super.updateInterface(),this.applyChangesButton&&this.applyChangesButton.hide()}saveHandler(e,t){this.onSave&&this.onSave(e,t)}deleteHandler(e,t){this.onDelete&&this.onDelete(e,t)}};Oe=f(Nr),K=h(Oe,0,"GridEditorDialog",yt,K),i(K,"GridEditorDialog"),g(Oe,1,K);var ht=K;import{Decorators as Hr,BaseDialog as jr,PropertyGrid as Mr,faIcon as Vr,resolveUrl as Kr,serviceCall as Gr}from"@serenity-is/corelib";import{postToUrl as Br}from"@serenity-is/corelib";var oe;(t=>{function r(o){var s,l;return{title:(s=o.title)!=null?s:"Report",cssClass:(l=o.cssClass)!=null?l:"print-button",icon:o.icon,onClick:i(()=>{t.execute(o)},"onClick")}}t.createToolButton=r,i(r,"createToolButton");function e(o){var l,u;var s=o.getParams?o.getParams():o.params;Br({url:"~/Serenity.Extensions/Report/"+(o.download?"Download":"Render"),params:{key:o.reportKey,ext:(l=o.extension)!=null?l:"pdf",opt:s?JSON.stringify(s):""},target:(u=o.target)!=null?u:"_blank"})}t.execute=e,i(e,"execute")})(oe||(oe={}));var xt,Ae,Ur;xt=[Hr.registerClass("Serenity.Extensions.ReportDialog")];var G=class G extends(Ur=jr){constructor(e){super(e),this.updateInterface(),this.loadReport(this.options.reportKey)}getDialogButtons(){return null}createPropertyGrid(){this.propertyGrid&&this.byId("PropertyGrid").empty().class(""),this.propertyGrid=new Mr({element:this.byId("PropertyGrid"),idPrefix:this.idPrefix,items:this.report.Properties}).init()}loadReport(e){Gr({url:Kr("~/Serenity.Extensions/Report/Retrieve"),request:{ReportKey:e},onSuccess:i(t=>{this.report=t,this.dialogTitle=this.report.Title,this.createPropertyGrid(),this.propertyGrid.load(this.report.InitialSettings||{}),this.updateInterface(),this.dialogOpen()},"onSuccess")})}updateInterface(){this.toolbar.findButton("print-preview-button").toggle(this.report&&!this.report.IsDataOnlyReport&&!this.report.IsExternalReport),this.toolbar.findButton("run-button").toggle(this.report&&this.report.IsExternalReport),this.toolbar.findButton("export-pdf-button").toggle(this.report&&!this.report.IsDataOnlyReport&&!this.report.IsExternalReport),this.toolbar.findButton("export-xlsx-button").toggle(this.report&&this.report.IsDataOnlyReport&&!this.report.IsExternalReport)}executeReport(e,t,o){if(this.validateForm()){var s={};this.propertyGrid.save(s),oe.execute({download:o,reportKey:this.report.ReportKey,extension:t,target:e,params:s})}}getToolbarButtons(){return[{title:"Preview",cssClass:"print-preview-button",onClick:i(()=>this.executeReport("_blank",null,!1),"onClick")},{title:"Run",cssClass:"run-button",icon:Vr("print","blue"),onClick:i(()=>this.executeReport("_blank",null,!1),"onClick")},{title:"PDF",cssClass:"export-pdf-button",onClick:i(()=>this.executeReport("_blank","pdf",!0),"onClick")},{title:"Excel",cssClass:"export-xlsx-button",onClick:i(()=>this.executeReport("_blank","xlsx",!0),"onClick")}]}renderContents(){let e=this.useIdPrefix();return v("div",{class:"s-DialogContent",children:[v("div",{id:e.Toolbar,class:"s-DialogToolbar"}),v("div",{class:"s-Form",children:v("form",{id:e.Form,action:"",children:v("div",{id:e.PropertyGrid})})})]})}};Ae=f(Ur),G=h(Ae,0,"ReportDialog",xt,G),i(G,"ReportDialog"),g(Ae,1,G);var se=G;import{Decorators as Wr,Fluent as zr,QuickSearchInput as Jr,Widget as Qr,stripDiacritics as bt}from"@serenity-is/corelib";var Pt,Le,Yr;Pt=[Wr.registerClass("Serenity.Extensions.ReportPage")];var U=class U extends(Yr=Qr){constructor(e){super(e),zr.on(this.domNode,"click",".report-link",this.reportLinkClick.bind(this)),new Jr({element:this.domNode.querySelector(".s-QuickSearchBar input"),onSearch:i((t,o,s)=>{this.updateMatchFlags(o),s(!0)},"onSearch")})}updateMatchFlags(e){var t=this.domNode.querySelectorAll(".report-list li");if(t.forEach(n=>n.classList.remove("non-match")),e=e==null?void 0:e.trim(),!e)return;e=bt(e).toUpperCase();var o=Array.from(t).filter(n=>n.classList.contains("report-item"));o.forEach(function(n){var m;var c=bt(((m=n.textContent)!=null?m:"").toUpperCase());c.indexOf(e)<0&&n.classList.add("non-match")});function s(n,c){let m=[];for(;(n=n.parentNode)&&n!==document;)(!c||n.matches(c))&&m.push(n);return m}i(s,"parents");var l=o.filter(n=>!n.classList.contains("non-match")),u=[...l];l.forEach(n=>u.push(...s(n,"li"))),u=u.filter((n,c)=>u.indexOf(n)===c),u.forEach(n=>{n.querySelectorAll(":scope [data-bs-toggle]:not([aria-expanded=true])").forEach(c=>{c.setAttribute("aria-expanded","true"),c.classList.remove("collapsed")}),n.parentElement&&n.parentElement.classList.contains("collapse")&&!n.parentElement.classList.contains("show")&&n.parentElement.classList.add("show")});var a=Array.from(t).filter(n=>u.indexOf(n)<0);a.forEach(n=>n.classList.add("non-match"))}reportLinkClick(e){e.preventDefault(),new se({reportKey:e.target.getAttribute("data-key")}).dialogOpen()}};Le=f(Yr),U=h(Le,0,"ReportPage",Pt,U),i(U,"ReportPage"),g(Le,1,U);var vt=U;var ke=class ke{async getItem(e){return(await Promise.resolve(X.Retrieve({PreferenceType:"UserPreferenceStorage",Name:e}))).Value}async setItem(e,t){return Promise.resolve(X.Update({PreferenceType:"UserPreferenceStorage",Name:e,Value:t}))}};i(ke,"UserPreferenceStorage");var Ct=ke;import{Dialog as Fe,Fluent as qe,confirmDialog as Xr,isArrayLike as Zr,localText as Tt}from"@serenity-is/corelib";var St;(e=>{function r(t,o){var s=Zr(t)?t[0]:t;if(!s)return;Fe.onClose(s,(u,a)=>{u==="save-and-close"||u==="save"||u==="delete"||u==="done"||s.dataset.ackuntil&&new Date().getTime()<parseInt(s.dataset.ackuntil,10)||!o()||(a.preventDefault(),a.stopImmediatePropagation(),Xr(Tt("Site.Dialogs.PendingChangesConfirmation"),()=>{var n;s.dataset.ackuntil=""+new Date().getTime()+1e3,(n=s.querySelector("div.save-and-close-button"))==null||n.click()},{onNo:i(function(){var n;s.dataset.ackuntil=""+new Date().getTime()+1e3,(n=Fe.getInstance(s))==null||n.close(u)},"onNo")}))},{before:!0});function l(){if(!(!qe.isVisibleLike(s)||!o()))return Tt("Site.Dialogs.PendingChangesUnloadWarning")}i(l,"beforeUnload"),qe.on(window,"beforeunload",l),Fe.onClose(s,()=>qe.off(window,"beforeunload",l),{oneOff:!0})}e.pendingChangesConfirmation=r,i(r,"pendingChangesConfirmation")})(St||(St={}));import{Decorators as $r,PropertyDialog as _r,cancelDialogButton as eo,getTypeFullName as to,okDialogButton as ro,toggleClass as oo}from"@serenity-is/corelib";var wt,Ne,so;wt=[$r.registerClass("Serenity.Extensions.PromptDialog")];var N=class N extends(so=_r){constructor(e){if(super(e),this.options.cssClass&&oo(this.domNode,this.options.cssClass),this.options.message){var t=document.createElement("div");t.classList.add("message"),this.byId("PropertyGrid").prepend(t),this.options.isHtml?t.innerHTML=this.options.message:t.textContent=this.options.message}this.dialogTitle=this.options.title||"Prompt"}getDialogButtons(){return[ro({click:i(e=>{if(!this.validateForm()){e.preventDefault();return}this.options.validateValue!=null&&!this.options.validateValue(this.value)&&e.preventDefault()},"click")}),eo()]}loadInitialEntity(){this.value=this.options.value}getPropertyItems(){var e;return[{name:"Value",editorType:typeof this.options.editorType=="function"?to(this.options.editorType):this.options.editorType||"String",required:(e=this.options.required)!=null?e:!0,editorParams:this.options.editorOptions}]}get value(){return this.getSaveEntity().Value}set value(e){this.propertyGrid.load({Value:e})}static prompt(e,t,o,s){new N({title:e,message:t,value:o,validateValue:i(l=>s(l),"validateValue")}).dialogOpen()}};Ne=f(so),N=h(Ne,0,"PromptDialog",wt,N),i(N,"PromptDialog"),g(Ne,1,N);var Et=N;import{Decorators as io,EntityGrid as no}from"@serenity-is/corelib";import{RowSelectionModel as ao}from"@serenity-is/sleekgrid";var Rt,Be,lo;Rt=[io.registerClass("Serenity.Extensions.SelectableEntityGrid")];var W=class W extends(lo=no){getSlickOptions(){var e=super.getSlickOptions();return e.enableTextSelectionOnCells=!0,e.selectedCellCssClass="slick-row-selected",e.enableCellNavigation=!0,e}createSlickGrid(){var e=super.createSlickGrid();return e.setSelectionModel(new ao),e}};Be=f(lo),W=h(Be,0,"SelectableEntityGrid",Rt,W),i(W,"SelectableEntityGrid"),g(Be,1,W);var Dt=W;import{Decorators as It,ISetEditValue as uo,Widget as po,localText as co}from"@serenity-is/corelib";var At,He,mo;At=[It.element("<div/>"),It.registerEditor("Serenity.Extensions.StaticTextBlock",[uo])];var z=class z extends(mo=po){constructor(e){var t;if(super(e),this.options.hideLabel){let o=(t=this.domNode.closest(".field"))==null?void 0:t.querySelector(".caption");o&&(o.style.display="none")}this.updateElementContent()}updateElementContent(){var t;var e=(t=this.options.text)!=null?t:this.value;this.options.isLocalText&&(e=co(e)),this.options.isHtml?this.domNode.innerHTML=e:this.domNode.textContent=e}setEditValue(e,t){var o;this.options.text==null&&(this.value=(o=this.options.text)!=null?o:e[t.name],this.updateElementContent())}};He=f(mo),z=h(He,0,"StaticTextBlock",At,z),i(z,"StaticTextBlock"),g(He,1,z);var Ot=z;import{getRemoteDataAsync as fo,localText as $,stringFormat as Lt}from"@serenity-is/corelib";async function go(){return await fo("PasswordStrengthRules")}i(go,"getPasswordStrengthRules");function Vi(r,e){go().then(t=>{r.addValidationRule(()=>{if(r.value.length<t.MinPasswordLength)return Lt($("Validation.MinRequiredPasswordLength"),t.MinPasswordLength)},e),t.RequireDigit&&r.addValidationRule(()=>{if(!/[0-9]/.test(r.value))return Lt($("Validation.PasswordStrengthRequireDigit"))},e),t.RequireLowercase&&r.addValidationRule(()=>{if(!/[a-z\p{Ll}]/u.test(r.value))return $("Validation.PasswordStrengthRequireDigit")},e),t.RequireUppercase&&r.addValidationRule(()=>{if(!/[A-Z\p{Lu}]/u.test(r.value))return $("Validation.PasswordStrengthRequireUppercase")},e),t.RequireNonAlphanumeric&&r.addValidationRule(()=>{if(!/[^\s\p{L}]/u.test(r.value))return $("Validation.PasswordStrengthRequireNonAlphanumeric")},e)})}i(Vi,"addPasswordStrengthValidation");export{te as BasicProgressDialog,ot as BulkServiceAction,Je as ChangePasswordForm,St as DialogUtils,ut as EnumSelectFormatter,st as ExcelExportHelper,Qe as ForgotPasswordForm,mt as GridEditorBase,ht as GridEditorDialog,lt as PdfExportHelper,Et as PromptDialog,se as ReportDialog,oe as ReportHelper,vt as ReportPage,Ye as ResetPasswordForm,Dt as SelectableEntityGrid,ct as SingleLineTextFormatter,Ot as StaticTextBlock,Xe as UserPreferenceRow,X as UserPreferenceService,Ct as UserPreferenceStorage,Vi as addPasswordStrengthValidation,go as getPasswordStrengthRules};
//# sourceMappingURL=index.js.map
